# WeKnora å¼€å‘ç¯å¢ƒå¿«é€Ÿå…¥é—¨

> æ— éœ€é‡æ–°æ„å»º Docker é•œåƒï¼Œå®ç°ç§’çº§ä»£ç çƒ­æ›´æ–°ï¼

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3 ç§æ–¹å¼ï¼‰

### æ–¹å¼ 1ï¼šæ¨è - ä½¿ç”¨ Make å‘½ä»¤

**ç»ˆç«¯ 1** - å¯åŠ¨åŸºç¡€è®¾æ–½ï¼š
```bash
make dev-start
```

**ç»ˆç«¯ 2** - å¯åŠ¨åç«¯ï¼š
```bash
make dev-app
```

**ç»ˆç«¯ 3** - å¯åŠ¨å‰ç«¯ï¼š
```bash
make dev-frontend
```

è®¿é—® http://localhost:5173 å¼€å§‹å¼€å‘ï¼

### æ–¹å¼ 2ï¼šä½¿ç”¨è„šæœ¬å‘½ä»¤

```bash
# ç»ˆç«¯ 1
./scripts/dev.sh start

# ç»ˆç«¯ 2
./scripts/dev.sh app

# ç»ˆç«¯ 3
./scripts/dev.sh frontend
```

### æ–¹å¼ 3ï¼šä¸€é”®å¯åŠ¨ï¼ˆäº¤äº’å¼ï¼‰

```bash
./scripts/quick-dev.sh
```

æŒ‰ç…§æç¤ºé€‰æ‹©æ˜¯å¦å¯åŠ¨åç«¯å’Œå‰ç«¯ã€‚

## ğŸ“‹ å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make dev-start` | å¯åŠ¨åŸºç¡€è®¾æ–½ï¼ˆpostgres, redis, minio ç­‰ï¼‰ |
| `make dev-stop` | åœæ­¢æ‰€æœ‰æœåŠ¡ |
| `make dev-restart` | é‡å¯æ‰€æœ‰æœåŠ¡ |
| `make dev-status` | æŸ¥çœ‹æœåŠ¡çŠ¶æ€ |
| `make dev-logs` | æŸ¥çœ‹æœåŠ¡æ—¥å¿— |
| `make dev-app` | å¯åŠ¨åç«¯ï¼ˆéœ€å…ˆå¯åŠ¨åŸºç¡€è®¾æ–½ï¼‰ |
| `make dev-frontend` | å¯åŠ¨å‰ç«¯ï¼ˆéœ€å…ˆå¯åŠ¨åŸºç¡€è®¾æ–½ï¼‰ |

## ğŸ¯ è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ |
|------|------|
| å‰ç«¯å¼€å‘æœåŠ¡å™¨ | http://localhost:5173 |
| åç«¯ API | http://localhost:8080 |
| PostgreSQL | localhost:5432 |
| Redis | localhost:6379 |
| MinIO Console | http://localhost:9001 |
| Neo4j Browser | http://localhost:7474 |
| Jaeger UI | http://localhost:16686 |

## ğŸ’¡ å¼€å‘å·¥ä½œæµå¯¹æ¯”

### âŒ æ—§æ–¹å¼ï¼ˆæ…¢ï¼‰

```bash
# æ¯æ¬¡ä¿®æ”¹ä»£ç å
sh scripts/build_images.sh -p      # é‡æ–°æ„å»ºé•œåƒï¼ˆ2-5åˆ†é’Ÿï¼‰
sh scripts/start_all.sh --no-pull  # é‡å¯å®¹å™¨
```

### âœ… æ–°æ–¹å¼ï¼ˆå¿«ï¼‰

```bash
# é¦–æ¬¡å¯åŠ¨ï¼ˆåªéœ€ä¸€æ¬¡ï¼‰
make dev-start

# ä¿®æ”¹åç«¯ä»£ç 
# â†’ Ctrl+C åœæ­¢ â†’ make dev-app é‡å¯ï¼ˆ5-10ç§’ï¼‰

# ä¿®æ”¹å‰ç«¯ä»£ç 
# â†’ è‡ªåŠ¨çƒ­é‡è½½ï¼ˆæ— éœ€ä»»ä½•æ“ä½œï¼‰
```

**æ—¶é—´å¯¹æ¯”**ï¼š
- æ—§æ–¹å¼ï¼šæ¯æ¬¡ä¿®æ”¹ 2-5 åˆ†é’Ÿ
- æ–°æ–¹å¼é¦–æ¬¡ï¼š1-2 åˆ†é’Ÿ
- æ–°æ–¹å¼åç»­ï¼š
  - åç«¯ä¿®æ”¹ï¼š5-10 ç§’
  - å‰ç«¯ä¿®æ”¹ï¼šå®æ—¶çƒ­é‡è½½

## ğŸ”¥ è¿›é˜¶ï¼šåç«¯çƒ­é‡è½½

å®‰è£… Air å®ç°åç«¯ä»£ç ä¿®æ”¹åè‡ªåŠ¨é‡å¯ï¼š

```bash
# å®‰è£… Air
go install github.com/cosmtrek/air@latest

# ç¡®ä¿ $GOPATH/bin åœ¨ PATH ä¸­
export PATH=$PATH:$(go env GOPATH)/bin

# ä½¿ç”¨ Air å¯åŠ¨ï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰
make dev-app
# æˆ–ç›´æ¥è¿è¡Œ
air
```

ä¿®æ”¹ Go ä»£ç åï¼ŒAir ä¼šè‡ªåŠ¨é‡æ–°ç¼–è¯‘å’Œé‡å¯ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œï¼

## ğŸ“ å¼€å‘åœºæ™¯ç¤ºä¾‹

### åœºæ™¯ 1ï¼šåªä¿®æ”¹å‰ç«¯

```bash
# ä¸€æ¬¡æ€§å¯åŠ¨åŸºç¡€è®¾æ–½
make dev-start

# å¯åŠ¨å‰ç«¯ï¼Œä¿®æ”¹ä»£ç è‡ªåŠ¨çƒ­é‡è½½
make dev-frontend
```

### åœºæ™¯ 2ï¼šåªä¿®æ”¹åç«¯

```bash
# å¯åŠ¨åŸºç¡€è®¾æ–½
make dev-start

# å¯åŠ¨åç«¯ï¼ˆå¦‚æœå®‰è£…äº† Airï¼Œæ”¯æŒçƒ­é‡è½½ï¼‰
make dev-app
```

### åœºæ™¯ 3ï¼šåŒæ—¶å¼€å‘å‰åç«¯

```bash
# ç»ˆç«¯ 1ï¼šå¯åŠ¨åŸºç¡€è®¾æ–½
make dev-start

# ç»ˆç«¯ 2ï¼šå¯åŠ¨åç«¯
make dev-app

# ç»ˆç«¯ 3ï¼šå¯åŠ¨å‰ç«¯
make dev-frontend
```

## ğŸ›  VS Code è°ƒè¯•é…ç½®

åˆ›å»º `.vscode/launch.json`ï¼š

```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Launch WeKnora Server",
            "type": "go",
            "request": "launch",
            "mode": "auto",
            "program": "${workspaceFolder}/cmd/server",
            "env": {
                "DB_HOST": "localhost",
                "DB_PORT": "5432",
                "DOCREADER_ADDR": "localhost:50051",
                "MINIO_ENDPOINT": "localhost:9000",
                "REDIS_ADDR": "localhost:6379",
                "OTEL_EXPORTER_OTLP_ENDPOINT": "localhost:4317",
                "NEO4J_URI": "bolt://localhost:7687"
            }
        }
    ]
}
```

ç„¶åæŒ‰ F5 å¼€å§‹è°ƒè¯•ï¼

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ï¼šå¯åŠ¨åç«¯æ—¶æŠ¥é”™è¿æ¥ä¸åˆ°æ•°æ®åº“

**è§£å†³**ï¼šç¡®ä¿å…ˆè¿è¡Œäº† `make dev-start` å¹¶ç­‰å¾… 30 ç§’è®©æœåŠ¡å®Œå…¨å¯åŠ¨ã€‚

æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š
```bash
make dev-status
```

### é—®é¢˜ï¼šå‰ç«¯è®¿é—® API æ—¶æŠ¥ CORS é”™è¯¯

**è§£å†³**ï¼šå‰ç«¯å·²é…ç½®ä»£ç†ï¼Œç¡®ä¿ï¼š
1. åç«¯è¿è¡Œåœ¨ `localhost:8080`
2. å‰ç«¯è¿è¡Œåœ¨ `localhost:5173`
3. æŸ¥çœ‹ `frontend/vite.config.ts` çš„ä»£ç†é…ç½®

### é—®é¢˜ï¼šç«¯å£è¢«å ç”¨

**è§£å†³**ï¼šä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ç«¯å£é…ç½®ï¼š

```bash
# .env
DB_PORT=5433        # é»˜è®¤ 5432
REDIS_PORT=6380     # é»˜è®¤ 6379
MINIO_PORT=9001     # é»˜è®¤ 9000
```

ç„¶åé‡å¯æœåŠ¡ï¼š
```bash
make dev-restart
```

### é—®é¢˜ï¼šDocReader éœ€è¦é‡æ–°æ„å»º

**è§£å†³**ï¼šDocReader ä»ä½¿ç”¨ Docker é•œåƒï¼Œéœ€è¦é‡æ–°æ„å»ºï¼š

```bash
sh scripts/build_images.sh -d
make dev-restart
```

## ğŸ¯ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

å¼€å‘å®Œæˆåéœ€è¦éƒ¨ç½²æ—¶ï¼š

```bash
# æ„å»ºæ‰€æœ‰é•œåƒ
sh scripts/build_images.sh

# æˆ–åªæ„å»ºç‰¹å®šé•œåƒ
sh scripts/build_images.sh -p  # åç«¯
sh scripts/build_images.sh -f  # å‰ç«¯
sh scripts/build_images.sh -d  # DocReader

# å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
sh scripts/start_all.sh
```

## ğŸ“š æ›´å¤šæ–‡æ¡£

- [å®Œæ•´å¼€å‘æŒ‡å—](docs/å¼€å‘æŒ‡å—.md)
- [API æ–‡æ¡£](docs/API.md)
- [Agent å¼€å‘](docs/AGENT.md)

## ğŸ’ª æœ€ä½³å®è·µ

1. **æ—¥å¸¸å¼€å‘**ï¼šä½¿ç”¨ `make dev-*` å‘½ä»¤ï¼Œäº«å—å¿«é€Ÿè¿­ä»£
2. **æäº¤å‰æµ‹è¯•**ï¼šä½¿ç”¨å®Œæ•´ Docker ç¯å¢ƒæµ‹è¯•é›†æˆåŠŸèƒ½
3. **ç”Ÿäº§éƒ¨ç½²**ï¼šä½¿ç”¨æ„å»ºé•œåƒçš„æ–¹å¼éƒ¨ç½²

## ğŸ‰ æ€»ç»“

ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼Œä½ å¯ä»¥ï¼š

âœ… **ä¸é‡æ–°æ„å»ºé•œåƒ** - ç›´æ¥åœ¨æœ¬åœ°è¿è¡Œä»£ç   
âœ… **ç§’çº§çƒ­æ›´æ–°** - å‰ç«¯è‡ªåŠ¨çƒ­é‡è½½ï¼Œåç«¯å¿«é€Ÿé‡å¯  
âœ… **å®Œæ•´è°ƒè¯•æ”¯æŒ** - IDE æ–­ç‚¹è°ƒè¯•ï¼Œå®æ—¶æŸ¥çœ‹å˜é‡  
âœ… **èŠ‚çœæ—¶é—´** - æ¯æ¬¡ä¿®æ”¹ä» 2-5 åˆ†é’Ÿé™è‡³ 5-10 ç§’  

ç¥ä½ å¼€å‘æ„‰å¿«ï¼ğŸš€

